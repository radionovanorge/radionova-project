{% extends "tears/base.html" %}
{% load wagtailcore_tags %}
{% load wagtailimages_tags %}
{% load static %}
{% block content %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programoversikt</title>
    <script src="https://cdn.tailwindcss.com"></script>
     <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'nova-red': '#4D0F1E',
                        'nova-dark-red': '#4D0F1E',
                        'nova-brown': '#92400e',
                        'nova-burgundy': '#671620'
                    }
                }
            }
        }
    </script>

</head>

<body class="bg-gray-100 font-sans antialiased">


    <!-- Header Section -->

    <header class="w-full p-10">
        <div class="max-w-[1068px] mx-auto px-200">
            <!-- Breadcrumb Navigation -->
             <div class="text-sm text-gray-500 mb-4 mt-1">
    {% if self.get_ancestors|length > 1 %}
    <nav aria-label="Breadcrumb">
        <ul class="flex items-center space-x-2 flex-wrap">
            {% for p in self.get_ancestors %}
            {% if not p.is_root %}
            <li class="flex items-center {% if forloop.counter > 1 and forloop.counter < forloop.parentloop.counter0|add:'-1' %}hidden sm:flex{% endif %}">
                <a href="{{ p.url }}" class="hover:text-red-600 transition-colors">{{ p.title }}</a>
                <span class="mx-2 text-gray-400">→</span>
            </li>
            {% endif %}
            {% endfor %}
            <!-- Show ellipsis on small screens if there are hidden items -->
            {% if self.get_ancestors|length > 3 %}
            <li class="sm:hidden flex items-center">
                <span class="text-gray-400">...</span>
                <span class="mx-2 text-gray-400">→</span>
            </li>
            {% endif %}
            <!-- Current Page -->
            <li class="text-red-600 font-semibold">{{ self.title }}</li>
        </ul>
    </nav>
    {% endif %}
</div>
        </div>
        <div class="w-full max-w-[910px] mx-auto mt-10 ">
            

            <!-- Title Section -->
             <h1 class="text-[47px] font-bold text-black-800">Programmer</h1>
      
        
       
  </div>
        
    </header>
<main class=" bg-[#FFF7F7]">
    <div class="w-full max-w-[1270px] mx-auto px-4 lg:px-8 xl:px-12 2xl:px-20 flex flex-col lg:flex-row gap-8 py-8">
    <!-- Main Content Wrapper -->
    <div class="flex flex-col lg:flex-row gap-8 ">

        <!-- Filter Sidebar (No borders) -->
        <aside class="w-full lg:w-1/4 p-4">
                <!-- Search Bar -->
       <form id="programSearchForm" method="get" class="w-full max-w-md mx-auto mb-6">
  <div class="relative">
    <!-- Search Icon -->
    <div class="absolute left-3 top-1/2 transform -translate-y-1/2 text-[#6F1228]">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
    </div>

    <!-- Input Field -->
    <input
      type="text"
      name="q"
      value="{{ q }}"
      placeholder="Søk"
      class="w-full pl-10 pr-10 py-3 rounded-lg border border-[#6F1228] text-[#6F1228] placeholder-[#6F1228] focus:outline-none focus:ring-2 focus:ring-[#6F1228]"
    />

    <!-- Clear Button -->
    <button
      type="button"
      id="clearSearch"
      class="absolute right-3 top-1/2 transform -translate-y-1/2 text-[#6F1228] hover:text-[#4D0F1E]"
      onclick="document.querySelector('input[name=q]').value = ''"
      {% if q %}
      style="display: block;"
      {% else %}
      style="display: none;"
      {% endif %}
    >
      ✕
    </button>

    <!-- Hidden fields to preserve filters -->
   
    <input type="hidden" name="tema" value="{{ selected_tema|default:'' }}">
    
  </div>
</form>
            <details class="group bg-white mb-6" open>
  <summary class="list-none cursor-pointer">
    <div class="p-6 text-[#6F1228] text-[16px] leading-[25.7px] font-normal flex items-center justify-between">
      Tema
      <svg class="w-5 h-5 transition-transform duration-200 rotate-180 group-open:rotate-0"
           fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M19 9l-7 7-7-7"></path>
      </svg>
    </div>
  </summary>

  <div class="px-6 pb-6">
    <div class="flex flex-col gap-3">

      {% comment %} Aktualitet {% endcomment %}
      <div class="flex items-center">
        <label class="flex items-center cursor-pointer relative">
          <input type="checkbox" name="tema" value="Aktualitet"
                 class="peer filter-checkbox h-6 w-6 cursor-pointer transition-all appearance-none rounded border border-slate-300 checked:bg-[#4D0F1E] checked:border-[#4D0F1E]" />
          <span class="pointer-events-none absolute text-white opacity-0 peer-checked:opacity-100 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="w-4 h-4">
              <path d="M18 6 L6 18 M6 6 L18 18" stroke="white" stroke-width="2" />
            </svg>
          </span>
        </label>
        <span class="ml-3 text-gray-700">Aktualitet</span>
      </div>

      {% comment %} Diverse {% endcomment %}
      <div class="flex items-center">
        <label class="flex items-center cursor-pointer relative">
          <input type="checkbox" name="tema" value="Diverse"
                 class="peer filter-checkbox h-6 w-6 cursor-pointer transition-all appearance-none rounded border border-slate-300 checked:bg-[#4D0F1E] checked:border-[#4D0F1E]" />
          <span class="pointer-events-none absolute text-white opacity-0 peer-checked:opacity-100 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="w-4 h-4">
              <path d="M18 6 L6 18 M6 6 L18 18" stroke="white" stroke-width="2" />
            </svg>
          </span>
        </label>
        <span class="ml-3 text-gray-700">Diverse</span>
      </div>

      {% comment %} Humor & underholdning {% endcomment %}
      <div class="flex items-center">
        <label class="flex items-center cursor-pointer relative">
          <input type="checkbox" name="tema" value="Humor & underholdning"
                 class="peer filter-checkbox h-6 w-6 cursor-pointer transition-all appearance-none rounded border border-slate-300 checked:bg-[#4D0F1E] checked:border-[#4D0F1E]" />
          <span class="pointer-events-none absolute text-white opacity-0 peer-checked:opacity-100 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="w-4 h-4">
              <path d="M18 6 L6 18 M6 6 L18 18" stroke="white" stroke-width="2" />
            </svg>
          </span>
        </label>
        <span class="ml-3 text-gray-700">Humor & underholdning</span>
      </div>

      {% comment %} Kultur {% endcomment %}
      <div class="flex items-center">
        <label class="flex items-center cursor-pointer relative">
          <input type="checkbox" name="tema" value="Kultur"
                 class="peer filter-checkbox h-6 w-6 cursor-pointer transition-all appearance-none rounded border border-slate-300 checked:bg-[#4D0F1E] checked:border-[#4D0F1E]" />
          <span class="pointer-events-none absolute text-white opacity-0 peer-checked:opacity-100 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="w-4 h-4">
              <path d="M18 6 L6 18 M6 6 L18 18" stroke="white" stroke-width="2" />
            </svg>
          </span>
        </label>
        <span class="ml-3 text-gray-700">Kultur</span>
      </div>

      {% comment %} Tema {% endcomment %}
      <div class="flex items-center">
        <label class="flex items-center cursor-pointer relative">
          <input type="checkbox" name="tema" value="Tema"
                 class="peer filter-checkbox h-6 w-6 cursor-pointer transition-all appearance-none rounded border border-slate-300 checked:bg-[#4D0F1E] checked:border-[#4D0F1E]" />
          <span class="pointer-events-none absolute text-white opacity-0 peer-checked:opacity-100 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="w-4 h-4">
              <path d="M18 6 L6 18 M6 6 L18 18" stroke="white" stroke-width="2" />
            </svg>
          </span>
        </label>
        <span class="ml-3 text-gray-700">Tema</span>
      </div>

    </div>
  </div>
</details>
        </aside>

        <!-- Programs Grid -->
        <div class="flex-1">

            <!-- Sorting Controls -->
            <div class="flex justify-between items-center mb-6 max-w-[821px]">
                <p id="resultCount" class="ml-[15px]">Viser {{ total_program_count }} treff</p>
                <div class="flex gap-2 mr-5">
                     <button id="toggleViewBtn" class="flex items-center px-4 py-2 border-2 border-red-900 hover:bg-gray-50 transition-colors focus-within:ring-2 focus-within:ring-red-900">
        <!-- Grid/rutenett icon -->
        <svg class="w-4 h-4 text-red-900 hidden" id="gridIcon" fill="currentColor" viewBox="0 0 24 24">
            <path d="M3 3h6v6H3V3zm8 0h6v6h-6V3zm-8 8h6v6H3v-6zm8 0h6v6h-6v-6zm0 8h6v6h-6v-6zm-8 0h6v6H3v-6z"/>
        </svg>
        <svg class="w-4 h-4 text-red-900" id="listIcon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 20 20" aria-hidden="true">
            <!-- Outline versjon - bedre kontrast -->
            <path d="M4 6h16M4 10h16M4 14h16" stroke-linecap="round"/>
        </svg>
        <span class="ml-2 text-red-900 font-medium">Vis som liste</span>
    </button>
                    <div
                            class="relative inline-flex items-stretch overflow-hidden">
                   <select id="sortSelect"
    class="bg-white border-0 text-black-900 font-medium pl-2 pr-14 py-2 text-sm outline-none w-full cursor-pointer ml-2 text-red-900 border-2 border-red-900 hover:bg-gray-50 focus-within:ring-2 focus-within:ring-red-900"
    aria-label="Sorter">
    <option value="asc">Programnavn A til Å</option>
    <option value="desc">Programnavn Å til A</option>
</select>
                            <div
                                class="absolute inset-y-0 right-0 w-8 bg-nova-dark-red flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                    aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                                        d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                            </div>


                </div>
            </div>

            <!-- Programs Grid Layout 1 -->
            <div id="programGrid" class="program-rutenett grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2 mr-1">
                

                {% for category_name, programs in grouped_programs.items %}
                {% for program in programs %}

                <div class=" p-4" data-category="{{ category_name }}">
                    <a href="{{ program.url }}" class="image-link">
                        {% if program.main_image %}
                        {% image program.main_image fill-150x150 as img %}
                        <img src="{{ img.url }}" alt="{{ program.title }}" class="w-full mb-2">
                        {% endif %}
                        <h3 class="font-semibold mb-1 break-words max-w-full">{{ program.title }}</h3>

                        <!-- Assign category colors based on the category_name -->
                        {% if category_name == 'Aktualitet' %}
                        <span
                            class="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded-full">{{ category_name }}</span>
                        {% elif category_name == 'Humor & underholdning' %}
                        <span
                            class="text-xs px-2 py-1 bg-pink-100 text-pink-700 rounded-full">{{ category_name }}</span>
                        {% elif category_name == 'Kultur' %}
                        <span
                            class="text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full">{{ category_name }}</span>
                        {% elif category_name == 'Musikk' %}
                        <span
                            class="text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full">{{ category_name }}</span>
                        {% elif category_name == 'Tema' %}
                        <span
                            class="text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded-full">{{ category_name }}</span>
                        {% elif category_name == 'Tidligere_programmer' %}
                        <span
                            class="text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded-full">{{ category_name }}</span>
                        {% endif %}
                    </a>
                </div>

                {% endfor %}
                {% endfor %}

            </div>

            <!-- Hero cards on programs, does not show until you click the vis som liste button-->
            <!-- Programs List Layout 2 -->
            <div id="programGrid" class="space-y-8 program-list" style="display:none;">

                {% for category_name, programs in grouped_programs.items %}
                {% for program in programs %}
                <div class="flex flex-col md:flex-row p-4 rounded gap-4" data-category="{{ category_name }}">

                    <!-- Image -->
                    {% if program.main_image %}
                    <div class="md:w-1/4">
                        {% image program.main_image fill-300x300 as img %}
                        <img src="{{ img.url }}" alt="{{ program.title }}" class="w-full h-auto rounded">
                    </div>
                    {% endif %}

                    <!-- Content -->
                    <!-- Content -->
                    <div class="flex-1 flex flex-col gap-1 md:gap-1.5">
                        {% if program.schedule_info %}
                        <p class="text-sm text-gray-700 font-medium">{{ program.schedule_info }}</p>
                        {% endif %}

                        <!-- Title + Tag -->
                        <div class="flex flex-wrap items-baseline gap-2">
                            <a href="{{ program.url }}">
                                <h3 class="text-xl font-semibold text-[#4b0c1b] leading-tight">{{ program.title }}</h3>
                            </a>
                            {% if category_name == 'Aktualitet' %}
                            <span
                                class="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded-full">{{ category_name }}</span>
                            {% elif category_name == 'Humor & underholdning' %}
                            <span
                                class="text-xs px-2 py-1 bg-pink-100 text-pink-700 rounded-full">{{ category_name }}</span>
                            {% elif category_name == 'Kultur' %}
                            <span
                                class="text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full">{{ category_name }}</span>
                            {% elif category_name == 'Musikk' %}
                            <span
                                class="text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full">{{ category_name }}</span>
                            {% elif category_name == 'Tema' %}
                            <span
                                class="text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded-full">{{ category_name }}</span>
                            {% elif category_name == 'Tidligere programmer' %}
                            <span
                                class="text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded-full">{{ category_name }}</span>
                            {% endif %}
                        </div>

                        {% if program.intro %}
                        <p class="text-sm text-gray-700">{{ program.intro }}</p>
                        {% endif %}
                    </div>

                </div>
                {% endfor %}
                {% endfor %}

            </div>


        </div>
    </div>
    </div>
</main>
</div>
    <script src="{% static 'tears/js/programmer_page.js' %}?v={% now 'U' %}" defer></script>
</body>


{% endblock %}