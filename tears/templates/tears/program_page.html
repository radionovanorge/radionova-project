{% extends "tears/base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}
{% load static %}
{% block content %}


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programoversikt</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="{% static 'tears/js/naavaerendeprogram.js' %}?v={% now 'U' %}"></script>

</head>
<header class="w-full bg-[#f7f4f4] p-10 mb-8">
    <div class="program-container px-4 py-8 max-w-4xl mx-auto">
        <!-- Breadcrumb -->
        <div class="breadcrumb-content text-sm text-gray-500 mb-4 mt-1">
            {% if self.get_ancestors|length > 1 %}
            <nav aria-label="Breadcrumb">
                <ul class="flex items-center space-x-2">
                    {% for p in self.get_ancestors %}
                    {% if not p.is_root %}
                    <li>
                        <a href="{{ p.url }}" class="hover:text-red-600">{{ p.title }}</a>
                        <span class="mx-2 text-gray-400">></span>
                    </li>
                    {% endif %}
                    {% endfor %}
                    <!-- Current Page -->
                    <li class="text-red-600 font-semibold">{{ self.title }}</li>
                </ul>
            </nav>
            {% endif %}
        </div>

        <!-- Flex Layout for Header Content -->
        <!-- Flex Layout for Header Content -->
        <div class="flex flex-col-reverse lg:flex-row lg:items-start gap-6">
            <!-- Left Column: Text and Info -->
            <div class="flex-1">
                <!-- Title -->
                <h1 class="program-title text-3xl font-bold text-gray-900 mb-2">{{ page.title }}</h1>


                <div class="flex flex-wrap items-center justify-start gap-x-2 gap-y-0 text-sm text-gray-700 mb-3">
                    <div class="flex flex-wrap items-center justify-between gap-x-2 gap-y-1 mb-2">

                        {# Left: rotating weekday • time #}
                        <div id="sendetid-rotator" class="relative min-h-[1.75rem] flex-1">
                            <span id="sendetid-current"
                                class="text-[#4b0c1b] font-sans text-lg leading-tight transition-opacity duration-300 opacity-100"></span>

                            {# Hidden source items for the rotator #}
                            {% if page.sendetider %}
                            <div class="mt-2">
                                {% for block in page.sendetider %}
                                {% if block.block_type == "sendetid" and block.value.weekday and block.value.start_time and block.value.end_time %}
                                <div class="mb-1">
                                    <span class="text-[#4b0c1b] font-sans text-lg rot-item hidden">
                                        {% if block.value.weekday == "1" %}Mandager{% elif block.value.weekday == "2" %}Tirsdager{% elif block.value.weekday == "3" %}Onsdager{% elif block.value.weekday == "4" %}Torsdager{% elif block.value.weekday == "5" %}Fredager{% elif block.value.weekday == "6" %}Lørdager{% elif block.value.weekday == "7" %}Søndager{% endif %}
                                        &bull; {{ block.value.start_time }} - {{ block.value.end_time }}
                                    </span>
                                </div>
                                {% endif %}
                                {% endfor %}
                            </div>
                            {% endif %}

                        </div>

                        {# Right: category badge #}
                        {% if page.category %}
                        {% with category_name=page.get_category_display %}
                        <span class="px-3 py-1 mb-1 rounded-full text-base
                   {% if category_name == 'Aktualitet' %} bg-blue-100 text-blue-700
                   {% elif category_name == 'Humor & underholdning' %} bg-pink-100 text-pink-700
                   {% elif category_name == 'Kultur' %} bg-green-100 text-green-700
                   {% elif category_name == 'Musikk' %} bg-yellow-100 text-yellow-700
                   {% elif category_name == 'Tema' %} bg-purple-100 text-purple-700
                   {% else %} bg-neutral-100 text-neutral-700 {% endif %}">
                            {{ category_name }}
                        </span>
                        {% endwith %}
                        {% endif %}

                    </div>



                </div>




                <!-- Intro Text -->
                {% if page.intro %}
                <p class="program-intro text-base text-gray-800 leading-relaxed mb-4">
                    {{ page.intro }}
                </p>
                {% endif %}


                <!-- Social Media Links -->
                <div class="flex flex-wrap gap-6 text-sm text-gray-700 mt-4">
                    {% if page.facebook_link %}
                    <a href="{{ page.facebook_link }}" class="flex items-center space-x-2 hover:underline">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 320 512"
                            class="w-5 h-5">
                            <path
                                d="M80 299.3V512H196V299.3h86.5l18-97.8H196V166.9c0-51.7 20.3-71.5 72.7-71.5c16.3 0 29.4 .4 37 1.2V7.9C291.4 4 256.4 0 236.2 0C129.3 0 80 50.5 80 159.4v42.1H14v97.8H80z" />
                        </svg>
                        <span>Facebook</span>
                    </a>
                    {% endif %}

                    {% if page.instagram_link %}
                    <a href="{{ page.instagram_link }}" class="flex items-center space-x-2 hover:underline">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 170 170"
                            class="w-5 h-5">
                            <path d="M122.406,0H46.654C20.929,0,0,20.93,0,46.655v75.752c0,25.726,20.929,46.655,46.654,46.655h75.752
      c25.727,0,46.656-20.93,46.656-46.655V46.655C169.063,20.93,148.133,0,122.406,0z M154.063,122.407
      c0,17.455-14.201,31.655-31.656,31.655H46.654C29.2,154.063,15,139.862,15,122.407V46.655C15,29.201,29.2,15,46.654,15h75.752
      c17.455,0,31.656,14.201,31.656,31.655V122.407z" />
                            <path
                                d="M84.531,40.97c-24.021,0-43.563,19.542-43.563,43.563c0,24.02,19.542,43.561,43.563,43.561s43.563-19.541,43.563-43.561
      C128.094,60.512,108.552,40.97,84.531,40.97z M84.531,113.093c-15.749,0-28.563-12.812-28.563-28.561
      c0-15.75,12.813-28.563,28.563-28.563s28.563,12.813,28.563,28.563C113.094,100.281,100.28,113.093,84.531,113.093z" />
                            <path d="M129.921,28.251c-2.89,0-5.729,1.17-7.77,3.22c-2.051,2.04-3.23,4.88-3.23,7.78c0,2.891,1.18,5.73,3.23,7.78
      c2.04,2.04,4.88,3.22,7.77,3.22c2.9,0,5.73-1.18,7.78-3.22c2.05-2.05,3.22-4.89,3.22-7.78c0-2.9-1.17-5.74-3.22-7.78
      C135.661,29.421,132.821,28.251,129.921,28.251z" />
                        </svg>
                        <span>Instagram</span>
                    </a>
                    {% endif %}


                    {% if page.tiktok_link %}
                    <a href="{{ page.tiktok_link }}" class="flex items-center space-x-2 hover:underline">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 448 512"
                            class="w-5 h-5">
                            <path
                                d="M448 209.9a210.1 210.1 0 0 1 -122.8-39.3V349.4A162.6 162.6 0 1 1 185 188.3V278.2a74.6 74.6 0 1 0 52.2 71.2V0l88 0a121.2 121.2 0 0 0 1.9 22.2A122.2 122.2 0 0 0 381 102.4a121.4 121.4 0 0 0 67 20.1z" />
                        </svg>
                        <span>TikTok</span>
                    </a>
                    {% endif %}

                    {% if page.email_link %}
                    <a href="mailto:{{ page.email_link }}" class="flex items-center space-x-2 hover:underline">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-5 h-5">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
                        </svg>
                        <span>E-post</span>
                    </a>
                    {% endif %}
                </div>

            </div>


            <!-- Right Column: Main Image -->
            {% if page.main_image %}
            <div class="flex-shrink-0 w-full max-w-xs">
                {% image page.main_image width-800 class="program-image w-full h-auto object-cover" %}
            </div>
            {% endif %}
        </div>
</header>

<!-- Spotifywidgets more info and nettsaker -->

<section class="px-2 py-12 max-w-4xl mx-auto">
    <div class="program-content">
        {% for block in page.description %}
        {{ block.value }}
        {% endfor %}
    </div>


</section>
<!-- Nettsaker only the program has written-->
{% with blog_posts=page.blog_posts.live %}
{% if blog_posts %}
<div class=" mx-auto px-6 mt-16 bg-[#f7f4f4] py-12">
    <h2 class="text-3xl font-bold text-[#511120] mb-6 text-center">Mer fra {{ page.title }}</h2>
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-8">
        {% for post in blog_posts|slice:":3" %}
        <a href="{{ post.url }}"
            class="group block rounded-lg shadow-md overflow-hidden transition-transform transform hover:scale-105">
            {% for block in post.body %}
            {% if block.block_type == "main_image" %}
            {% image block.value fill-600x400 as img %}
            <div class="thumb" style="
                 background-image: url('{{ img.url }}');
                 width: 100%;
                 height: 250px;
                 background-size: cover;
                 background-position: center;
                 background-repeat: no-repeat;"></div>
            {% endif %}
            {% endfor %}
            <div class="p-4">
                <h3 class="text-lg font-semibold group-hover:text-[#511120]">{{ post.title }}</h3>
                <!-- This can be too much text and makes the box too long <p class="text-sm text-gray-500">{{ post.ingress|default:"- Nettsak" }}</p> -->
            </div>
        </a>

        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

</div>
</section>
</div>


{% endblock %}